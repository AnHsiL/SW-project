var MongoClient = require('mongodb').MongoClient;

module.exports = function findDataByCondition(findData){

    let result = {};
    return new Promise((resolve, reject) =>{
        MongoClient.connect("mongodb://localhost:27017/signData", function(err,db){
            if(err){
                console.log(err);
                result.status = "連線失敗"
                result.err = "伺服器錯誤!"
                reject(result);
                return;
            }

            var dbo = db.db('signData');
            var projection = {
                _id :           0,
                account:        1,
                password:       0,
                name :          1,
                phone :         1,
                gender :        1,
                license :       1,
                helmet :        1,
                location :      1,
                workingTime :   1,
                other :         1,
                status :        1
            }

            dbo.collection('userList').find(findData, projection).toArray().then(function(err, res){
                if(err){
                    console.log(err);
                    result.status = "連線失敗"
                    result.err = "伺服器錯誤!"
                    reject(result);
                    return;
                }else{
                    if(res == null){
                        result.foundData = {};
                        reject(result);
                    }
                    else{
                        //result.foundData = res;
                        //console.log(result.foundData);
                        resolve(result);
                    }
                }
            })
        })
    })
}